(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{4911:function(e,t,n){var r=n(4912);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(19)(r,a);r.locals&&(e.exports=r.locals)},4912:function(e,t,n){(t=e.exports=n(18)(!1)).push([e.i,"._3Ix0WjhiPcwnS2{padding:12px;color:#5e6c84}._3Ix0WjhiPcwnS2 input{width:100%}._3Ix0WjhiPcwnS2 button{width:100%;margin:16px 0 0}.jdTcFpD3-nI6Sm{margin:16px 0 8px;font-weight:700;font-size:14px;color:#172b4d}._1NYql4rFP67pCj{margin:8px 0;font-weight:700;color:#b04632}",""]),t.locals={popoverContent:"_3Ix0WjhiPcwnS2",popoverLabel:"jdTcFpD3-nI6Sm",popoverError:"_1NYql4rFP67pCj"}},4959:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n(0),a=n.n(r),o=n(6),i=n.n(o),l=n(26),c=n(3),u=n(24),s=n(261),m=n(989),f=n(44),d=n(4911),b=n.n(d);function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function g(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var v=Object(c.forNamespace)(["email hygiene wizard","change email"],{shouldEscapeStrings:!1}),y=function(e){var t=e.disabled,n=void 0!==t&&t,o=e.onSubmitEmail,c=void 0===o?function(e){}:o,d=e.isSendingRequest,h=e.emailError,y=e.onTogglePopover,E=e.emailPlaceholder,S=void 0===E?"":E,w=e.children,j=g(Object(r.useState)(S),2),A=j[0],I=j[1],x=Object(u.usePopover)({onHide:function(){y(!1)},onShow:function(){y(!0)}}),k=x.popoverProps,M=x.toggle,O=x.triggerRef;return a.a.createElement(a.a.Fragment,null,a.a.createElement(l.a,{onClick:M,ref:O,disabled:n},w),a.a.createElement(u.Popover,p({},k,{title:v("title")}),a.a.createElement("div",{className:b.a.popoverContent},a.a.createElement("form",{onSubmit:function(e){e.preventDefault(),c(A)}},a.a.createElement("div",null,v("main-message"),d&&a.a.createElement(f.a,{small:!0,inline:!0,wrapperClassName:i()(b.a.spinner,b.a.floating)})),h&&a.a.createElement(s.a,{error:h,email:A},(function(e){return a.a.createElement("p",{className:b.a.popoverError},e)})),a.a.createElement("label",{htmlFor:"email",className:b.a.popoverLabel},v("email-label")),a.a.createElement("input",{id:"email",type:"email",name:"email",value:A,ref:function(e){return e&&e.focus()},onChange:function(e){return I(e.target.value)},disabled:d}),a.a.createElement(m.a,{disabled:d||0===A.length,onClick:function(e){e.preventDefault(),c(A)}},v("send-confirmation-button"))))))}},5413:function(e,t,n){var r=n(5414);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(19)(r,a);r.locals&&(e.exports=r.locals)},5414:function(e,t,n){(t=e.exports=n(18)(!1)).push([e.i,"._3Bd6HnKKkhFGD_{display:flex;flex:1;flex-direction:column;max-height:328px}._3Bd6HnKKkhFGD_ .G69uEb3MtDy4ET{display:flex;flex-direction:column;overflow-y:auto}._3Bd6HnKKkhFGD_ ._2zWt-TAgMI95Ed{margin-top:30px}._3Bd6HnKKkhFGD_ ._2zWt-TAgMI95Ed button{margin-right:8px}._2KecRqjUIETpLX{word-wrap:break-word}@media only screen and (max-width:1020px){._3AU-NEKdBS7j3e{width:100%;min-width:375px}}._3Bd6HnKKkhFGD_ .G69uEb3MtDy4ET ul{list-style:disc;padding-left:16px}._3Bd6HnKKkhFGD_ .G69uEb3MtDy4ET ul li{word-break:break-word;margin-bottom:8px}",""]),t.locals={content:"_3Bd6HnKKkhFGD_",description:"G69uEb3MtDy4ET",buttons:"_2zWt-TAgMI95Ed",breakable:"_2KecRqjUIETpLX",illustration:"_3AU-NEKdBS7j3e"}},5415:function(e,t,n){e.exports=n.p+"images/aa-migration-wizard/illustration-error.04f84878bae2a86e48d7.svg"},5416:function(e,t,n){e.exports=n.p+"images/aa-migration-wizard/illustration-error-mobile.f1d7cd8e9f994511de69.svg"},5563:function(e,t,n){"use strict";n.r(t),n.d(t,"AtlassianAccountMigrationError",(function(){return C}));var r=n(0),a=n.n(r),o=n(8),i=n(393),l=n(9),c=n(22),u=n(3),s=n(261),m=n(4959),f=n(506),d=n(26),b=n(1),p=n(5413),g=n.n(p),h=n(1422);function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function E(e,t,n,r,a,o,i){try{var l=e[o](i),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,a)}function S(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){E(o,r,a,i,l,"next",e)}function l(e){E(o,r,a,i,l,"throw",e)}i(void 0)}))}}var w={main:{full:n(5415),mobile:n(5416)},email:{full:n(1551),mobile:n(1526)}},j=function(){var e=S(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.fetch(t);case 2:if(!(null==(n=e.sent)?void 0:n.ok)){e.next=5;break}return e.abrupt("return",n.text());case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=Object(u.forNamespace)(["aa migration wizard","email mismatch error"],{shouldEscapeStrings:!1}),I=new Map,x=function(e){var t=I.get(e);if(t)return t;var n=document.createElement("div");return n.className=g.a.illustration,I.set(e,n),j(e).then((function(e){e&&(n.innerHTML=e)})),n},k=function(e){var t=e.accounts,n=e.onClickMigrate,u=e.onDismiss,p=v(Object(r.useState)(),2),y=p[0],E=p[1];Object(r.useEffect)((function(){x(w.main.full),x(w.main.mobile)})),Object(r.useEffect)((function(){Object(i.b)(o.Source.aaMigrationWizardEmailMismatchScreen,{})}),[]);var j=v(Object(c.G)(),2),I=j[0],k=j[1],M=v(Object(r.useState)(s.b.None),2),O=M[0],_=M[1],D=function(){var e=S(regeneratorRuntime.mark((function e(n){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_(s.b.None),e.prev=1,t.trello.loginId){e.next=4;break}throw Error("No login ID provided");case 4:return e.next=6,I({variables:{loginId:t.trello.loginId,email:n}});case 6:E(n),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(1),r=e.t0.networkError?e.t0.networkError.message:e.t0.message,(a=Object(s.c)(r))?_(a):(console.error("Failed to change email",e.t0),_(s.b.Unknown));case 14:Object(i.a)({verb:b.Verb.CHANGES,noun:b.Noun.EMAIL,method:"by clicking change email button",context:{},source:o.Source.atlassianAccountMigrationChangeEmailInlineDialog,action:o.Action.clicked,actionSubject:o.ActionSubject.button,actionSubjectId:o.ActionSubjectId.atlassianAccountMigrationChangeEmailButton});case 15:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),N=Object(r.useCallback)((function(e){e&&Object(i.b)(o.Source.atlassianAccountMigrationChangeEmailInlineDialog,{})}),[]),C=Object(r.useCallback)((function(){u(),Object(i.a)({verb:b.Verb.DISMISSES,noun:b.Noun.AA_MIGRATION_WIZARD,method:"by dismissing the migration dialog",context:{},source:o.Source.aaMigrationWizardEmailMismatchScreen,action:o.Action.closed,actionSubject:o.ActionSubject.overlay,actionSubjectId:o.ActionSubjectId.atlassianAccountMigrationOverlay})}),[u]);return y?a.a.createElement(h.a,{image:x(w.email.full),mobileImage:x(w.email.mobile),email:y,closeDialog:C}):a.a.createElement(f.a,{closeDialog:C,title:A("title",{email:t.trello.email}),image:x(w.main.full),mobileImage:x(w.main.mobile)},a.a.createElement("div",{className:g.a.content},a.a.createElement("div",{className:g.a.description},a.a.createElement("p",{className:g.a.mainMessage},A("main-message")),a.a.createElement("p",null,A("secondary-message")),a.a.createElement("ul",null,a.a.createElement("li",{key:"log-in-with-aa-email"},A("log-in-to-atlassian-with-email",{email:t.trello.email})),a.a.createElement("li",{key:"change-your-trello-email"},A("change-your-email-address-for-trello")),a.a.createElement("li",{key:"change-your-atlassian-email"},A("change-your-email-address-for-atlassian",{atlassianAccount:a.a.createElement("a",{key:"aa-change-email-link",href:l.aaManagedProfileUrl+"/email",target:"_blank"},A("atlassian-account"))})))),a.a.createElement("div",{className:g.a.buttons},a.a.createElement(d.g,{onClick:n},A("log-in-to-atlassian")),t.trello.loginId&&a.a.createElement(m.a,{emailError:O,onSubmitEmail:D,onTogglePopover:N,isSendingRequest:k.loading,emailPlaceholder:t.atlassian.email||""},A("change-trello-email")))))},M=n(1421),O=n(44),_=n(1012);function D(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var C=function(e){var t=e.code,n=e.onRetry,l=e.onDismiss,c=D(Object(r.useState)(),2),u=c[0],s=c[1],m=Object(r.useCallback)((function(){l(),Object(i.a)({verb:b.Verb.INITIATES,noun:b.Noun.AA_MIGRATION_WIZARD,method:"by clicking log in with atlassian button",context:{},source:o.Source.atlassianAccountMigrationBanner,action:o.Action.clicked,actionSubject:o.ActionSubject.button,actionSubjectId:o.ActionSubjectId.atlassianAccountMigrationRetryButton}),n()}),[l,n]);switch(Object(r.useEffect)((function(){t===M.a.EMAIL_MISMATCH&&_.a.fetchAccountsInfo().then((function(e){return e&&s(e)}),(function(e){console.error("Failed to fetch emails",{err:e}),s({atlassian:{email:null},trello:{email:null,loginId:null}})}))}),[t]),t){case M.a.EMAIL_MISMATCH:return u?a.a.createElement(k,{onClickMigrate:m,accounts:u,onDismiss:l}):a.a.createElement(O.a,null);default:throw new Error("Unhandled error code: ".concat(t))}};t.default=C}}]);
//# sourceMappingURL=aa-migration-error.2a84835088aff8b056a5.js.map